clc;
close all;
clear all;
fill3([-9.66637 -9.43239 -9.07508 -9.89675 -10.3873 -10.0761 -9.66637 ],[18 5.95826 -18 -18 14.8933 18 18 ],[-15.6166 -18 -18 18 18 2.3344 -15.6166 ],[rand rand rand]);
grid on; hold on;
plot3([-18 18],[-18 -18],[18 18],'color',[1 0 0],'Linewidth',3);
grid on; hold on;
plot3([18 18],[-18 18],[18 18],'color',[1 0 0],'Linewidth',3);
grid on; hold on;
plot3([18 -18],[18 18],[18 18],'color',[1 0 0],'Linewidth',3);
grid on; hold on;
plot3([-18 -18],[18 -18],[18 18],'color',[1 0 0],'Linewidth',3);
grid on; hold on;
plot3([-18 18],[-18 -18],[-18 -18],'color',[1 0 0],'Linewidth',3);
grid on; hold on;
plot3([18 18],[-18 18],[-18 -18],'color',[1 0 0],'Linewidth',3);
grid on; hold on;
plot3([18 -18],[18 18],[-18 -18],'color',[1 0 0],'Linewidth',3);
grid on; hold on;
plot3([-18 -18],[18 -18],[-18 -18],'color',[1 0 0],'Linewidth',3);
grid on; hold on;
plot3([-18 18],[-18 -18],[-18 -18],'color',[1 0 0],'Linewidth',3);
grid on; hold on;
plot3([18 18],[-18 -18],[-18 18],'color',[1 0 0],'Linewidth',3);
grid on; hold on;
plot3([18 -18],[-18 -18],[18 18],'color',[1 0 0],'Linewidth',3);
grid on; hold on;
plot3([-18 -18],[-18 -18],[18 -18],'color',[1 0 0],'Linewidth',3);
grid on; hold on;
plot3([-18 18],[18 18],[-18 -18],'color',[1 0 0],'Linewidth',3);
grid on; hold on;
plot3([18 18],[18 18],[-18 18],'color',[1 0 0],'Linewidth',3);
grid on; hold on;
plot3([18 -18],[18 18],[18 18],'color',[1 0 0],'Linewidth',3);
grid on; hold on;
plot3([-18 -18],[18 18],[18 -18],'color',[1 0 0],'Linewidth',3);
grid on; hold on;
plot3([-18 -18],[-18 18],[-18 -18],'color',[1 0 0],'Linewidth',3);
grid on; hold on;
plot3([-18 -18],[18 18],[-18 18],'color',[1 0 0],'Linewidth',3);
grid on; hold on;
plot3([-18 -18],[18 -18],[18 18],'color',[1 0 0],'Linewidth',3);
grid on; hold on;
plot3([-18 -18],[-18 -18],[18 -18],'color',[1 0 0],'Linewidth',3);
grid on; hold on;
plot3([18 18],[-18 18],[-18 -18],'color',[1 0 0],'Linewidth',3);
grid on; hold on;
plot3([18 18],[18 18],[-18 18],'color',[1 0 0],'Linewidth',3);
grid on; hold on;
plot3([18 18],[18 -18],[18 18],'color',[1 0 0],'Linewidth',3);
grid on; hold on;
plot3([18 18],[-18 -18],[18 -18],'color',[1 0 0],'Linewidth',3);
grid on; hold on;
axis([-18 18 -18 18 -18 18])
hold on;
xlabel('x (m)');
ylabel('y (m)');
zlabel('z (m)');
title('DFN');


%***************mesh*****************
JM1 = [1 42 2 43 3 44 ;4 45 5 46 6 47 ;7 48 8 49 9 50 ;1 44 3 51 10 52 ;10 53 4 54 9 55 ;11 56 12 57 13 58 ;14 59 15 60 16 61 ;17 62 7 50 9 63 ;18 64 13 65 19 66 ;20 67 17 68 15 69 ;21 70 22 71 16 72 ;14 73 23 74 24 75 ;21 72 16 60 15 76 ;25 77 26 78 27 79 ;14 80 11 81 15 59 ;28 82 29 83 26 84 ;30 85 17 86 4 87 ;31 88 32 89 33 90 ;34 91 35 92 4 93 ;36 94 37 95 35 96 ;28 97 22 98 29 82 ;14 99 12 56 11 80 ;34 100 36 96 35 91 ;35 95 37 101 38 102 ;28 103 25 104 16 105 ;16 104 25 106 23 107 ;11 58 13 64 18 108 ;39 109 11 108 18 110 ;1 111 8 112 40 113 ;1 52 10 55 9 114 ;34 115 32 116 36 100 ;30 87 4 92 35 117 ;36 116 32 88 31 118 ;36 118 31 119 37 94 ;22 120 35 102 38 121 ;22 121 38 122 29 98 ;14 61 16 107 23 73 ;14 75 24 123 12 99 ;20 124 39 125 7 126 ;7 127 41 128 8 48 ;39 110 18 129 41 130 ;39 130 41 127 7 125 ;34 93 4 47 6 131 ;34 131 6 132 32 115 ;17 63 9 54 4 86 ;20 69 15 81 11 133 ;21 134 30 117 35 135 ;30 136 15 68 17 85 ;20 133 11 109 39 124 ;20 126 7 62 17 67 ;28 84 26 77 25 103 ;28 105 16 71 22 97 ;21 76 15 136 30 134 ;21 135 35 120 22 70 ;10 51 3 137 5 138 ;10 138 5 45 4 53 ;1 114 9 49 8 111 ;1 113 40 139 2 42 ;];
JXY1 = [-9.86149 -11.8973 12.4674 ;-9.89675 -17.9998 17.9998 ;-9.73242 -17.9998 10.7998 ;-9.60287 -10.1535 -0.0027833 ;-9.56808 -17.9998 3.59978 ;-9.40375 -17.9998 -3.60001 ;-9.99384 -1.55104 11.5057 ;-10.093 -4.84248 17.9998 ;-9.82457 -8.12849 8.38732 ;-9.7151 -13.6489 7.19834 ;-10.0672 7.97982 8.49117 ;-10.1798 16.9645 7.55602 ;-10.2836 15.9289 12.778 ;-9.91311 11.6473 -0.655313 ;-9.82435 1.85746 1.8527 ;-9.72178 7.97351 -6.6377 ;-9.84137 -2.79595 5.63912 ;-10.2892 8.31472 17.9998 ;-10.3873 14.8933 17.9998 ;-9.96417 2.45298 7.58944 ;-9.65287 2.35789 -5.98735 ;-9.5336 2.96137 -11.6075 ;-9.93952 18 -3.64929 ;-10.0761 18 2.33418 ;-9.80294 18 -9.63297 ;-9.54938 11.9792 -16.8084 ;-9.66637 18 -15.6166 ;-9.60241 8.58833 -12.2691 ;-9.43239 5.9583 -18 ;-9.68432 -3.92687 -0.502768 ;-9.16441 -12.0102 -18 ;-9.23942 -17.9998 -10.8 ;-9.07509 -17.9998 -18 ;-9.39341 -13.1814 -7.20162 ;-9.5335 -3.02973 -7.69724 ;-9.35641 -9.01759 -11.5433 ;-9.25374 -6.0207 -18 ;-9.34306 -0.0313011 -18 ;-10.1342 5.02694 13.3564 ;-9.99486 -11.4211 17.9998 ;-10.1911 1.73602 17.9998 ;-9.87912 -14.9486 15.2336 ;-9.81458 -17.9998 14.3998 ;-9.79695 -14.9486 11.6336 ;-9.58548 -14.0766 1.7985 ;-9.48592 -17.9998 -0.000116381 ;-9.50331 -14.0766 -1.8014 ;-10.0434 -3.19676 14.7528 ;-9.95877 -6.48549 13.1936 ;-9.90921 -4.83976 9.94654 ;-9.72376 -15.8244 8.99905 ;-9.7883 -12.7731 9.83287 ;-9.65899 -11.9012 3.59778 ;-9.71372 -9.14099 4.19227 ;-9.76984 -10.8887 7.79283 ;-10.1235 12.4722 8.0236 ;-10.2317 16.4467 10.167 ;-10.1754 11.9544 10.6346 ;-9.86873 6.75239 0.598695 ;-9.77306 4.91549 -2.3925 ;-9.81744 9.81041 -3.64651 ;-9.91761 -2.17349 8.57243 ;-9.83297 -5.46222 7.01322 ;-10.2864 12.1218 15.3889 ;-10.3354 15.4111 15.3889 ;-10.3383 11.604 17.9998 ;-9.90277 -0.171484 6.61428 ;-9.83286 -0.469242 3.74591 ;-9.89426 2.15522 4.72107 ;-9.59323 2.65963 -8.79742 ;-9.62769 5.46744 -9.12259 ;-9.68732 5.1657 -6.31253 ;-9.92631 14.8236 -2.1523 ;-10.0078 18 -0.657554 ;-9.9946 14.8236 0.839436 ;-9.73861 2.10768 -2.06732 ;-9.67616 14.9896 -13.2207 ;-9.60788 14.9896 -16.2125 ;-9.73466 18 -12.6248 ;-9.99014 9.81356 3.91793 ;-9.94576 4.91864 5.17194 ;-9.5174 7.27331 -15.1345 ;-9.49088 8.96873 -17.4042 ;-9.5759 10.2837 -14.5387 ;-9.76285 -3.36141 2.56818 ;-9.72212 -6.47471 2.81817 ;-9.6436 -7.04018 -0.252776 ;-9.20192 -15.005 -14.4 ;-9.15725 -17.9998 -14.4 ;-9.11975 -15.005 -18 ;-9.46345 -8.10557 -7.44943 ;-9.56818 -6.59161 -3.85001 ;-9.49814 -11.6674 -3.6022 ;-9.30507 -7.51915 -14.7717 ;-9.39362 -4.52522 -12.8486 ;-9.44495 -6.02366 -9.62029 ;-9.56801 5.77485 -11.9383 ;-9.48299 4.45984 -14.8037 ;-10.0465 14.3059 3.45035 ;-9.37491 -11.0995 -9.37248 ;-9.2984 -3.026 -18 ;-9.43828 -1.53052 -12.8486 ;-9.70268 13.2941 -10.951 ;-9.76236 12.9867 -8.13533 ;-9.6621 8.28092 -9.4534 ;-9.87123 18 -6.64113 ;-9.83065 12.9867 -5.1435 ;-10.1782 8.14727 13.2455 ;-10.1007 6.50338 10.9238 ;-10.2117 6.67083 15.6781 ;-9.97723 -8.3699 15.2336 ;-10.0439 -8.13178 17.9998 ;-9.92818 -11.6592 15.2336 ;-9.84303 -10.0129 10.4274 ;-9.31641 -15.5906 -9.00081 ;-9.29792 -13.5087 -11.1717 ;-9.60891 -3.4783 -4.1 ;-9.26041 -10.5139 -14.7717 ;-9.20907 -9.01545 -18 ;-9.53355 -0.0341799 -9.65236 ;-9.43833 1.46504 -14.8037 ;-9.38773 2.9635 -18 ;-10.128 17.4822 4.9451 ;-10.0492 3.73996 10.4729 ;-10.064 1.73795 12.4311 ;-9.97901 0.450971 9.54759 ;-10.0925 0.0924893 14.7528 ;-10.142 -1.55323 17.9998 ;-10.2401 5.02537 17.9998 ;-10.1626 3.38148 15.6781 ;-9.39858 -15.5906 -5.40081 ;-9.32159 -17.9998 -7.20001 ;-10.0157 5.2164 8.0403 ;-9.6686 -0.78449 -3.24506 ;-9.59318 -0.335922 -6.84229 ;-9.75434 -1.0347 0.674968 ;-9.65025 -17.9998 7.19977 ;-9.64159 -15.8243 5.39906 ;-9.94581 -14.7104 17.9998 ;];
[me1, ne1] = size(JM1);
AAA1 = [rand rand rand]
for i = 1:me1
	for j = 1:ne1
		x1=JXY1(JM1(i, j), 1)
		x2=JXY1(JM1(i, (j + 1) - fix((j+1)/(ne1+1))*(ne1)), 1)
		y1=JXY1(JM1(i, j), 2)
		y2=JXY1(JM1(i, (j + 1) - fix((j+1)/(ne1+1))*(ne1)), 2)
		z1=JXY1(JM1(i, j), 3)
		z2=JXY1(JM1(i, (j + 1) - fix((j+1)/(ne1+1))*(ne1)), 3)
		plot3([x1 x2],[y1 y2], [z1 z2],'color', AAA1,'Linewidth',0.05)
		hold on
	end;
end;


%***************boundary*****************
JB_1st1 = [2, 100; 8, 100; 18, 100; 19, 100; 29, 20; 31, 20; 33, 20; 37, 20; 38, 20; 40, 100; 41, 100; 66, 100; 90, 20; 101, 20; 112, 100; 119, 20; 122, 20; 128, 100; 129, 100; 139, 100; ];
[m1, n1] = size(JB_1st1);
for i = 1:m1
	xa1=JXY1(JB_1st1(i, 1), 1)
	ya1=JXY1(JB_1st1(i, 1), 2)
	za1=JXY1(JB_1st1(i, 1), 3)
	scatter3(xa1, ya1, za1, 30, 'k', 'filled');
	hold on;
end;

clear x1 x2 xa1 y1 y2 ya1 z1 z2 za1;

JB_2st1 = [
-9.89675, -17.9998, 17.9998;-9.81458, -17.9998, 14.3998;-9.73242, -17.9998, 10.7998;-9.56808, -17.9998, 3.59978;-9.48592, -17.9998, -0.000116381;-9.40375, -17.9998, -3.60001;-10.1798, 16.9645, 7.55602;-10.2317, 16.4467, 10.167;-10.2836, 15.9289, 12.778;-10.2836, 15.9289, 12.778;-10.3354, 15.4111, 15.3889;-10.3873, 14.8933, 17.9998;-9.93952, 18, -3.64929;-10.0078, 18, -0.657554;-10.0761, 18, 2.33418;-9.54938, 11.9792, -16.8084;-9.60788, 14.9896, -16.2125;-9.66637, 18, -15.6166;-9.66637, 18, -15.6166;-9.73466, 18, -12.6248;-9.80294, 18, -9.63297;-9.23942, -17.9998, -10.8;-9.15725, -17.9998, -14.4;-9.07509, -17.9998, -18;-9.80294, 18, -9.63297;-9.87123, 18, -6.64113;-9.93952, 18, -3.64929;-10.0761, 18, 2.33418;-10.128, 17.4822, 4.9451;-10.1798, 16.9645, 7.55602;-9.40375, -17.9998, -3.60001;-9.32159, -17.9998, -7.20001;-9.23942, -17.9998, -10.8;-9.73242, -17.9998, 10.7998;-9.65025, -17.9998, 7.19977;-9.56808, -17.9998, 3.59978;];

[mk1, nk1] = size(JB_2st1);
for i = 1:mk1
	xs1 = JB_2st1(i, 1)
	ys1 = JB_2st1(i, 2)
	zs1 = JB_2st1(i, 3)
	scatter3(xs1, ys1, zs1, 30, 'k', 'filled')
	hold on;
end;


clear xs1 ys1 zs1;

Tra_Node_1=[];
[mo1,no1] = size(Tra_Node_1);
for i = 1:mo1
	xs1 = Tra_Node_1(i, 1)
	ys1 = Tra_Node_1(i, 2)
	zs1 = Tra_Node_1(i, 3)
	scatter3(xs1, ys1, zs1, 30, 'k', 'filled')
	hold on;
end;

